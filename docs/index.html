<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>tljs</title><meta name="description" content="Documentation for tljs"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">tljs</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>tljs </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#tljs" id="tljs" style="color: inherit; text-decoration: none;">
  <h1>tljs</h1>
</a>
<p>A <a href="#benchmark">high performance</a> HTML5 parser for JavaScript.</p>
<p>This library wraps the Rust crate <a href="https://github.com/y21/tl">tl</a> and exposes its interface to JavaScript.</p>

<a href="#when-to-use" id="when-to-use" style="color: inherit; text-decoration: none;">
  <h2>When To Use</h2>
</a>
<p>This library can <em>very quickly</em> parse <em>very large</em> HTML documents. However, this library is not suitable for every use case.
In particular, if you find yourself having to do lots of operations on the nodes, this may not be for you, due to the overhead of calling into WebAssembly.
So, use this library if:</p>
<ul>
<li>Most of the time is likely spent parsing documents.</li>
<li>Not a lot of operations are done on the nodes.</li>
<li>You need to parse <em>large</em> documents (tens to hundreds of megabytes)</li>
</ul>
<p>In any case, you should benchmark this library for your specific use case, and see if you benefit from the fast parsing speeds, or if the WebAssembly overhead is a bottleneck.</p>

<a href="#how-to-use" id="how-to-use" style="color: inherit; text-decoration: none;">
  <h2>How To Use</h2>
</a>
<pre><code class="language-js"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tljs</span><span class="hl-1"> = </span><span class="hl-3">require</span><span class="hl-1">(</span><span class="hl-4">&#39;@y21/tljs&#39;</span><span class="hl-1">);</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">dom</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">tljs</span><span class="hl-1">.</span><span class="hl-3">parse</span><span class="hl-1">(</span><span class="hl-4">`</span><br/><span class="hl-4">    &lt;!DOCTYPE html&gt;</span><br/><span class="hl-4">    &lt;div&gt;</span><br/><span class="hl-4">        &lt;p id=&quot;greeting&quot;&gt;Hello World&lt;/p&gt;</span><br/><span class="hl-4">        &lt;img id=&quot;img&quot; src=&quot;image.png&quot; /&gt;</span><br/><span class="hl-4">    &lt;/div&gt;</span><br/><span class="hl-4">`</span><span class="hl-1">);</span><br/><br/><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-6">dom</span><span class="hl-1">.</span><span class="hl-3">getElementById</span><span class="hl-1">(</span><span class="hl-4">&#39;img&#39;</span><span class="hl-1">).</span><span class="hl-3">asTag</span><span class="hl-1">().</span><span class="hl-3">attributes</span><span class="hl-1">().</span><span class="hl-3">get</span><span class="hl-1">(</span><span class="hl-4">&#39;src&#39;</span><span class="hl-1">)); </span><span class="hl-7">// image.png</span><br/><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-6">dom</span><span class="hl-1">.</span><span class="hl-3">getElementById</span><span class="hl-1">(</span><span class="hl-4">&#39;greeting&#39;</span><span class="hl-1">).</span><span class="hl-3">asTag</span><span class="hl-1">().</span><span class="hl-3">innerText</span><span class="hl-1">()); </span><span class="hl-7">// Hello World</span><br/><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-6">dom</span><span class="hl-1">.</span><span class="hl-3">querySelector</span><span class="hl-1">(</span><span class="hl-4">&#39;p#greeting&#39;</span><span class="hl-1">).</span><span class="hl-3">asTag</span><span class="hl-1">().</span><span class="hl-3">innerText</span><span class="hl-1">()); </span><span class="hl-7">// Hello World</span><br/><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-6">dom</span><span class="hl-1">.</span><span class="hl-3">version</span><span class="hl-1">() === </span><span class="hl-6">tljs</span><span class="hl-1">.</span><span class="hl-6">HTMLVersion</span><span class="hl-1">.</span><span class="hl-2">HTML5</span><span class="hl-1">); </span><span class="hl-7">// true</span>
</code></pre>

<a href="#spec-compliance" id="spec-compliance" style="color: inherit; text-decoration: none;">
  <h2>Spec compliance</h2>
</a>
<p>This parser does <strong>not</strong> fully follow the HTML standard, however it is expected to be able to parse most &quot;sane&quot; HTML.
This greatly impacts performance and should be taken into consideration when comparing performance of different HTML parsers.
Not being bound to a spec enables a <em>lot</em> more optimization opportunities.</p>

<a href="#using-this-library-in-the-browser" id="using-this-library-in-the-browser" style="color: inherit; text-decoration: none;">
  <h2>Using this library in the browser</h2>
</a>
<p>It&#39;s possible to use this library in very &quot;restricted&quot; JavaScript environments (for example no access to the file system or network). By default, this library assumes it&#39;s running under Node.js and attempts to load the <code>.wasm</code> binary needed to call into Rust code using <code>require(&#39;fs&#39;).readFile</code>.</p>
<p>If you want to use this library in the browser or other environments, you need to override the default WebAssembly loading mechanism. This depends on your setup, but one way to achieve this would be to host the <code>.wasm</code> binary elsewhere (maybe serve it from your webserver) and use <code>fetch()</code> to get the binary.</p>
<pre><code class="language-js"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tljs</span><span class="hl-1"> = </span><span class="hl-3">require</span><span class="hl-1">(</span><span class="hl-4">&#39;@y21/tljs&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-7">// override the wasm loading function</span><br/><span class="hl-6">tljs</span><span class="hl-1">.</span><span class="hl-3">setInitializerCallback</span><span class="hl-1">(() </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-3">fetch</span><span class="hl-1">(</span><span class="hl-4">&#39;/tl.wasm&#39;</span><span class="hl-1">).</span><span class="hl-3">then</span><span class="hl-1">(</span><span class="hl-6">x</span><span class="hl-1"> </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-6">x</span><span class="hl-1">.</span><span class="hl-3">arrayBuffer</span><span class="hl-1">()); </span><span class="hl-7">// assuming `/tl.wasm` serves the binary.</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">tljs</span><span class="hl-1">.</span><span class="hl-3">parse</span><span class="hl-1">(</span><span class="hl-4">&#39;&lt;p&gt;Hello world&lt;/p&gt;&#39;</span><span class="hl-1">);</span>
</code></pre>
<p>It doesn&#39;t matter <em>how</em> you obtain the WebAssembly binary, but you&#39;ll need to return an <code>ArrayBuffer</code> from the initializer callback (can also be a promise resolving to an <code>ArrayBuffer</code>).</p>

<a href="#benchmark" id="benchmark" style="color: inherit; text-decoration: none;">
  <h2>Benchmark</h2>
</a>
<pre><code><span class="hl-8">tl</span><span class="hl-1">                 : </span><span class="hl-9">0.863912</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">0.528114</span><br/><span class="hl-8">htmlparser2</span><span class="hl-1">        : </span><span class="hl-9">2.02348</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">3.05865</span><br/><span class="hl-8">html5parser</span><span class="hl-1">        : </span><span class="hl-9">2.20736</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">2.66850</span><br/><span class="hl-6">htmlparser2</span><span class="hl-1">-</span><span class="hl-8">dom</span><span class="hl-1">    : </span><span class="hl-9">2.70631</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">3.40642</span><br/><span class="hl-6">html</span><span class="hl-1">-</span><span class="hl-6">dom</span><span class="hl-1">-</span><span class="hl-8">parser</span><span class="hl-1">    : </span><span class="hl-9">2.72998</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">3.56091</span><br/><span class="hl-6">neutron</span><span class="hl-1">-</span><span class="hl-8">html5parser</span><span class="hl-1">: </span><span class="hl-9">2.74419</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">1.52848</span><br/><span class="hl-6">node</span><span class="hl-1">-</span><span class="hl-6">html</span><span class="hl-1">-</span><span class="hl-8">parser</span><span class="hl-1">   : </span><span class="hl-9">2.89545</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">1.80618</span><br/><span class="hl-8">libxmljs</span><span class="hl-1">           : </span><span class="hl-9">4.20240</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">2.99146</span><br/><span class="hl-6">zeed</span><span class="hl-1">-</span><span class="hl-8">dom</span><span class="hl-1">           : </span><span class="hl-9">4.82065</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">2.86533</span><br/><span class="hl-6">htmljs</span><span class="hl-1">-</span><span class="hl-8">parser</span><span class="hl-1">      : </span><span class="hl-9">5.97658</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">6.65908</span><br/><span class="hl-8">parse5</span><span class="hl-1">             : </span><span class="hl-9">6.85238</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">7.75122</span><br/><span class="hl-6">arijs</span><span class="hl-1">-</span><span class="hl-8">stream</span><span class="hl-1">       : </span><span class="hl-9">18.7410</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">18.6447</span><br/><span class="hl-6">arijs</span><span class="hl-1">-</span><span class="hl-8">tree</span><span class="hl-1">         : </span><span class="hl-9">20.6841</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">19.4813</span><br/><span class="hl-8">htmlparser</span><span class="hl-1">         : </span><span class="hl-9">21.8427</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">154.758</span><br/><span class="hl-6">html</span><span class="hl-1">-</span><span class="hl-8">parser</span><span class="hl-1">        : </span><span class="hl-9">27.3543</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">20.7064</span><br/><span class="hl-8">saxes</span><span class="hl-1">              : </span><span class="hl-9">58.8234</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">167.164</span><br/><span class="hl-8">html5</span><span class="hl-1">              : </span><span class="hl-9">109.685</span><span class="hl-1"> </span><span class="hl-6">ms</span><span class="hl-1">/</span><span class="hl-6">file</span><span class="hl-1"> ± </span><span class="hl-9">146.399</span>
</code></pre>
<p>Benchmarked against real world data using <a href="https://github.com/AndreasMadsen/htmlparser-benchmark">AndreasMadsen/htmlparser-benchmark</a>.</p>
<p><em>Note: This benchmark only measures raw HTML parsing, not DOM interaction.</em></p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-enum"><a href="enums/HTMLVersion.html" class="tsd-kind-icon">HTMLVersion</a></li><li class="tsd-kind-class"><a href="classes/Attributes.html" class="tsd-kind-icon">Attributes</a></li><li class="tsd-kind-class"><a href="classes/ChildrenCollection.html" class="tsd-kind-icon">Children<wbr/>Collection</a></li><li class="tsd-kind-class tsd-has-type-parameter"><a href="classes/Collection.html" class="tsd-kind-icon">Collection</a></li><li class="tsd-kind-class tsd-has-type-parameter"><a href="classes/CollectionIter.html" class="tsd-kind-icon">Collection<wbr/>Iter</a></li><li class="tsd-kind-class"><a href="classes/Comment.html" class="tsd-kind-icon">Comment</a></li><li class="tsd-kind-class"><a href="classes/Dom.html" class="tsd-kind-icon">Dom</a></li><li class="tsd-kind-class"><a href="classes/GlobalNodeCollection.html" class="tsd-kind-icon">Global<wbr/>Node<wbr/>Collection</a></li><li class="tsd-kind-class"><a href="classes/Node.html" class="tsd-kind-icon">Node</a></li><li class="tsd-kind-class"><a href="classes/RawTag.html" class="tsd-kind-icon">Raw<wbr/>Tag</a></li><li class="tsd-kind-class"><a href="classes/Tag.html" class="tsd-kind-icon">Tag</a></li><li class="tsd-kind-interface"><a href="interfaces/ParserOptions.html" class="tsd-kind-icon">Parser<wbr/>Options</a></li><li class="tsd-kind-type-alias"><a href="modules.html#WasmBinaryCallback" class="tsd-kind-icon">Wasm<wbr/>Binary<wbr/>Callback</a></li><li class="tsd-kind-function"><a href="modules.html#initializeWasm" class="tsd-kind-icon">initialize<wbr/>Wasm</a></li><li class="tsd-kind-function"><a href="modules.html#initializeWasmSync" class="tsd-kind-icon">initialize<wbr/>Wasm<wbr/>Sync</a></li><li class="tsd-kind-function"><a href="modules.html#parse" class="tsd-kind-icon">parse</a></li><li class="tsd-kind-function"><a href="modules.html#setInitializerCallback" class="tsd-kind-icon">set<wbr/>Initializer<wbr/>Callback</a></li><li class="tsd-kind-function"><a href="modules.html#setWasmExports" class="tsd-kind-icon">set<wbr/>Wasm<wbr/>Exports</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>